- defaults:
    link:
      create: true
      relink: true

- clean:
    ~/:
      force: true
    ~/.config:
      recursive: true

- link:
    ~/.config/nvim:
        path: configs/nvim
    ~/.config/ghostty:
        path: configs/ghostty
    ~/.config/mise:
        path: configs/mise
    ~/.config/tmux:
        path: configs/tmux
    ~/.config/zellij:
        path: configs/zellij
    ~/.config/starship:
        path: configs/starship
    ~/.config/yazi:
        path: configs/yazi
    ~/.config/karabiner:
        path: configs/karabiner
    ~/.config/fish:
        path: configs/fish
    ~/.hammerspoon:
        path: configs/hammerspoon
    ~/.zshrc:
        path: configs/zsh/.zshrc


- shell:
    - [git submodule update --init --recursive, Installing submodules]
    -
      description: Installing linux dependencies
      command: |
        if [ "$(uname)" = "Linux" ]; then
          if ! dpkg -s build-essential >/dev/null 2>&1; then
            sudo apt-get update
            sudo apt-get install -y build-essential
          fi
        fi
      stdin: true
      stdout: true
      stderr: true
    -
      description: Installing homebrew packages
      command: brew bundle --cleanup -v --file configs/Brewfile
      stdin: true
      stdout: true
      stderr: true
    -
      description: Set zsh as default shell (only if needed)
      command: |
        if [ "$SHELL" != "$(command -v zsh)" ]; then
          echo "$(command -v zsh)" | sudo tee -a /etc/shells
          chsh -s "$(command -v zsh)"
        fi
      stdin: true
      stdout: true
      stderr: true
    -
      description: Install mise tools
      command: mise install
      stdin: true
      stdout: true
      stderr: true
    -
      description: Applying MacOS settings
      command: |
        if [ "$(uname)" = "Darwin" ]; then
          sh platforms/mac/settings.sh
        fi
      stdin: true
      stdout: true
      stderr: true
